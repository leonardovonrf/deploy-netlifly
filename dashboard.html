<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sistema de Formulários</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* --- ESTILOS VISUAIS --- */
        
        /* Sidebar Ativa */
        .nav-item.active .nav-link {
            color: #10B981 !important;
            background-color: rgba(16, 185, 129, 0.1);
            border-right: 3px solid #10B981;
        }
        .nav-item.active .nav-link i { color: #10B981 !important; }

        /* Correção dos Inputs no Modal (Fundo Escuro) */
        .modal-body input, 
        .modal-body select, 
        .dark-input {
            background-color: #374151 !important; /* Cinza Escuro */
            color: #ffffff !important;             /* Texto Branco */
            border: 1px solid #4b5563 !important;  /* Borda sutil */
            width: 100%;
            padding: 10px;
            border-radius: 6px;
            margin-top: 5px;
        }
        
        .modal-body input::placeholder { color: #9ca3af; }

        .modal-body input:focus, 
        .modal-body select:focus {
            border-color: #10B981 !important;
            outline: none;
        }

        /* Modal Fix */
        .modal {
            display: none;
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); z-index: 9999;
            align-items: center; justify-content: center;
        }
        .modal.flex { display: flex !important; }

        /* Tabela de Usuários */
        .users-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
        }
        .users-table th, .users-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            color: var(--text-color);
        }
        .users-table th {
            background-color: rgba(0,0,0,0.2);
            font-weight: 600;
        }
        .users-table tr:hover {
            background-color: rgba(255,255,255,0.02);
        }
        .action-btn-small {
            padding: 5px 10px;
            border-radius: 4px;
            margin-right: 5px;
            cursor: pointer;
            border: none;
            font-size: 0.8rem;
        }
        .btn-edit { background-color: #3b82f6; color: white; }
        .btn-delete { background-color: #ef4444; color: white; }
    </style>
</head>

<body class="dashboard-page">
    <header class="header">
        <div class="header-left">
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="logo">
                <span>Sistema de Formulários</span>
            </div>
        </div>

        <div class="header-right">
            <button class="theme-toggle" id="themeToggle" title="Alternar tema">
                <i class="fas fa-moon"></i>
            </button>

            <div class="user-menu">
                <button class="user-btn" id="userBtn">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <span class="user-name" id="userName">Usuário</span>
                    <i class="fas fa-chevron-down"></i>
                </button>

                <div class="user-dropdown" id="userDropdown">
                    <hr class="dropdown-divider">
                    <a href="#" class="dropdown-item" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                        Sair
                    </a>
                </div>
            </div>
        </div>
    </header>

    <aside class="sidebar" id="sidebar">
        <nav class="sidebar-nav">
            <ul class="nav-list">
                <li class="nav-item active">
                    <a href="#dashboard" class="nav-link" data-section="dashboard" onclick="handleNavClick(this, 'dashboard')">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#forms" class="nav-link" data-section="forms" onclick="handleNavClick(this, 'forms')">
                        <i class="fas fa-file-alt"></i>
                        <span>Formulários</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#create" class="nav-link" data-section="create" onclick="handleNavClick(this, 'create')">
                        <i class="fas fa-plus-circle"></i>
                        <span>Criar Formulário</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#reports" class="nav-link" data-section="reports" onclick="handleNavClick(this, 'reports')">
                        <i class="fas fa-chart-bar"></i>
                        <span>Relatórios</span>
                    </a>
                </li>
                
                <div id="admin-divider" style="display:none; border-top: 1px solid rgba(255,255,255,0.1); margin: 15px 0;"></div>

                <li class="nav-item admin-only" id="nav-manage-users" style="display: none;">
                    <a href="#users" class="nav-link" data-section="users" onclick="handleNavClick(this, 'users')">
                        <i class="fas fa-users-cog"></i>
                        <span>Gerenciar Usuários</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <main class="main-content">
        <section class="content-section active" id="dashboard-section">
            <div class="section-header">
                <h2>Dashboard</h2>
                <p>Visão geral do sistema de formulários</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
                    <div class="stat-content"><h3 id="totalForms">0</h3><p>Total de Formulários</p></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-clock"></i></div>
                    <div class="stat-content"><h3 id="pendingForms">0</h3><p>Pendentes</p></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-content"><h3 id="completedForms">0</h3><p>Concluídos</p></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-calendar-day"></i></div>
                    <div class="stat-content"><h3 id="todayForms">0</h3><p>Hoje</p></div>
                </div>
            </div>

            <div class="charts-row" style="display: grid; grid-template-columns: 1fr; gap: 20px; margin-bottom: 30px;">
                <div class="chart-card" style="background: var(--card-bg); padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">
                    <h3 style="margin-top: 0; color: var(--primary-color); border-bottom: 2px solid var(--border-color); padding-bottom: 10px; margin-bottom: 20px;">
                        <i class="fas fa-chart-pie" style="margin-right: 10px;"></i> Distribuição por Tipo de Ocorrência
                    </h3>
                    <div style="position: relative; height: 300px; width: 100%; display: flex; justify-content: center;">
                        <canvas id="originChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <div class="card-header">
                        <h3>Formulários Recentes</h3>
                        <a href="#forms" onclick="handleNavClick(document.querySelector('a[href=\'#forms\']'), 'forms')" class="view-all">Ver todos</a>
                    </div>
                    <div class="recent-forms" id="recentForms"></div>
                </div>
                <div class="dashboard-card">
                    <div class="card-header"><h3>Ações Rápidas</h3></div>
                    <div class="quick-actions">
                        <button class="action-btn primary"  onclick="handleNavClick(document.querySelector('a[href=\'#create\']'), 'create')"><i class="fas fa-plus"></i> Novo Formulário</button>
                        <button class="action-btn secondary" onclick="handleNavClick(document.querySelector('a[href=\'#forms\']'), 'forms')"><i class="fas fa-search"></i> Buscar Formulários</button>
                        <button class="action-btn secondary" onclick="handleNavClick(document.querySelector('a[href=\'#reports\']'), 'reports')"><i class="fas fa-download"></i> Gerar Relatório</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="content-section" id="forms-section">
            <div class="section-header"><h2>Gerenciar Formulários</h2><p>Visualize, edite e exclua formulários existentes</p></div>
            <div class="forms-toolbar">
                <div class="search-box"><i class="fas fa-search"></i><input type="text" placeholder="Buscar formulários..." id="searchForms"></div>
                <div class="toolbar-actions">
                    <div class="select-wrapper"><i class="fas fa-sort-amount-down"></i><select id="orderFilter" class="modern-select"><option value="recentes">Mais Recentes</option><option value="antigos">Mais Antigos</option></select></div>
                    <div class="select-wrapper"><i class="fas fa-filter"></i><select id="statusFilter" class="modern-select"><option value="">Todos os status</option><option value="pending">Pendente</option><option value="completed">Concluído</option><option value="draft">Rascunho</option></select></div>
                    <div class="select-wrapper">
                        <i class="fas fa-tags"></i>
                        <select id="originFilter" class="modern-select">
                            <option value="">Todos os Tipos</option>
                            <option value="Processo">Processo</option>
                            <option value="Acidente Químico">Acidente Químico</option>
                            <option value="Acidente/ incidente">Acidente / Incidente</option>
                            <option value="BC-Atendimento de eventos">BC - Eventos</option>
                            <option value="Atendimento de Emergência">Atend. Emergência</option>
                            <option value="Chamado de Emergência improcedente">Chamado Improd.</option>
                            <option value="Denuncia">Denúncia</option>
                            <option value="Incêndio">Incêndio</option>
                            <option value="Incidente Químico">Incidente Químico</option>
                            <option value="Inspeção de Segurança">Inspeção Seg.</option>
                            <option value="Princípio de incêndio">Princípio de Incêndio</option>
                            <option value="Rev./projeto_incêndio">Proj. Incêndio</option>
                            <option value="Treinamento SST">Treinamento SST</option>
                            <option value="Vazamento de água/vapor">Vazamento Água/Vapor</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>
                    <button class="btn secondary" id="refreshForms"><i class="fas fa-sync-alt"></i> Atualizar</button>
                </div>
            </div>
            <div class="forms-grid" id="formsGrid"></div>
        </section>

        <section class="content-section" id="create-section">
            <div class="section-header"><h2>Criar Novo Formulário</h2><p>Acesse o sistema de criação de formulários</p></div>
            <div class="create-form-card">
                <img src="logo_ccs.png" alt="Logo SST CCS-UFRJ" class="create-icon-logo">
                <h3>Criar Formulário Personalizado</h3>
                <p>Clique no botão abaixo para acessar o sistema de criação.</p>
                <a href="formulario.html" target="_blank" class="bg-green-600 hover:bg-green-700 text-white font-medium py-6 px-8 rounded-md shadow-md transition-colors"><i class="fas fa-external-link-alt"></i> Abrir Sistema de Criação</a>
                <div class="create-info"><div class="info-item"><i class="fas fa-info-circle"></i><span>O sistema será aberto em uma nova aba</span></div><div class="info-item"><i class="fas fa-save"></i><span>Formulários criados aparecerão automaticamente na lista</span></div></div>
            </div>
        </section>

        <section class="content-section" id="reports-section">
            <div class="section-header"><h2>Relatórios</h2><p>Gere e visualize relatórios dos formulários</p></div>
            <div class="reports-grid">
                <div class="report-card"><div class="report-icon"><i class="fas fa-chart-line"></i></div><h3>Relatório Mensal</h3><p>Estatísticas do mês atual</p><button class="btn secondary" id="btnRelatorioMensal">Gerar Relatório</button></div>
                <div class="report-card"><div class="report-icon"><i class="fas fa-file-export"></i></div><h3>Exportar Dados</h3><p>Exporte em formato CSV</p><button class="btn secondary">Exportar CSV</button></div>
                <div class="report-card"><div class="report-icon"><i class="fas fa-print"></i></div><h3>Imprimir Lista</h3><p>Imprima a lista atual</p><button class="btn secondary">Imprimir</button></div>
            </div>
        </section>

        <section class="content-section" id="users-section">
            <div class="section-header">
                <h2>Gerenciar Usuários</h2>
                <p>Lista de usuários cadastrados no sistema. (Exclusivo Admin)</p>
            </div>
            
            <div class="forms-toolbar">
                <button class="btn primary" onclick="openRegisterUserModal()">
                    <i class="fas fa-plus"></i> Novo Usuário
                </button>
            </div>

            <div style="overflow-x: auto;">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>E-mail</th>
                            <th>Cargo</th>
                            <th>Data Cadastro</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="usersListBody">
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 20px;">Carregando...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header"><h3>Edição rápida</h3><button class="modal-close" onclick="closeModal('editModal')"><i class="fas fa-times"></i></button></div>
            <div class="modal-body">
                <form id="editForm">
                    <div class="form-group"><label>Título</label><input type="text" id="editTitle" required class="dark-input"></div>
                    <div class="form-group"><label>Descrição</label><textarea id="editDescription" rows="3" class="dark-input"></textarea></div>
                    <div class="form-group"><label>Status</label><select id="editStatus" class="dark-input"><option value="draft">Rascunho</option><option value="pending">Pendente</option><option value="completed">Concluído</option></select></div>
                </form>
                <div style="margin-top:20px;padding-top:20px;border-top:1px solid #eee;"><button class="btn secondary" id="btnEditFullContent" style="width:100%;border-color:var(--primary-color);color:var(--primary-color);"><i class="fas fa-external-link-alt"></i> Editar Completo</button></div>
            </div>
            <div class="modal-footer"><button class="btn secondary" onclick="closeModal('editModal')">Cancelar</button><button class="btn primary" onclick="saveForm()">Salvar</button></div>
        </div>
    </div>

    <div class="modal" id="confirmModal">
        <div class="modal-content small">
            <div class="modal-header"><h3>Confirmar Ação</h3><button class="modal-close" onclick="closeModal('confirmModal')"><i class="fas fa-times"></i></button></div>
            <div class="modal-body"><p id="confirmMessage">Tem certeza?</p></div>
            <div class="modal-footer"><button class="btn secondary" onclick="closeModal('confirmModal')">Cancelar</button><button class="btn danger" id="confirmAction">Confirmar</button></div>
        </div>
    </div>

    <div class="modal" id="registerUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-plus" style="margin-right: 10px;"></i>Cadastrar Novo Usuário</h3>
                <button class="modal-close" onclick="closeUserModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="registerUserForm">
                    <div class="form-group">
                        <label for="regName">Nome Completo</label>
                        <input type="text" id="regName" placeholder="Ex: João Silva" required class="dark-input">
                    </div>
                    <div class="form-group">
                        <label for="regEmail">E-mail</label>
                        <input type="email" id="regEmail" placeholder="usuario@email.com" required class="dark-input">
                    </div>
                    <div class="form-group">
                        <label for="regPassword">Senha</label>
                        <input type="password" id="regPassword" placeholder="******" required class="dark-input">
                    </div>
                    <div class="form-group">
                        <label for="regRole">Cargo (Permissão)</label>
                        <select id="regRole" class="dark-input">
                            <option value="user">Usuário Comum (Visualizar/Editar)</option>
                            <option value="admin">Administrador (Acesso Total)</option>
                            <option value="estagiario">Estagiário</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" onclick="closeUserModal()">Cancelar</button>
                <button class="btn primary" onclick="registerNewUser()">Cadastrar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="editUserModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-edit" style="margin-right: 10px;"></i>Editar Usuário</h3>
                <button class="modal-close" onclick="closeModal('editUserModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="editUserId">
                <form id="editUserForm">
                    <div class="form-group">
                        <label>Nome Completo</label>
                        <input type="text" id="editUserName" class="dark-input">
                    </div>
                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" id="editUserEmail" class="dark-input">
                    </div>
                    <div class="form-group">
                        <label>Nova Senha (deixe em branco para manter)</label>
                        <input type="password" id="editUserPassword" placeholder="******" class="dark-input">
                    </div>
                    <div class="form-group">
                        <label>Cargo</label>
                        <select id="editUserRole" class="dark-input">
                            <option value="user">Usuário Comum</option>
                            <option value="admin">Administrador</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" onclick="closeModal('editUserModal')">Cancelar</button>
                <button class="btn primary" onclick="updateUser()">Salvar Alterações</button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast">
        <div class="toast-content"><i class="toast-icon"></i><span class="toast-message"></span></div>
        <button class="toast-close" onclick="hideToast()"><i class="fas fa-times"></i></button>
    </div>

    <script src="main.js"></script>
    <script src="auth.js"></script>
    <script src="forms.js"></script>
    <script src="dashboard.js"></script>

    <script>
        // --- NAVEGAÇÃO ---
        function handleNavClick(element, sectionId) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            if(element.closest('.nav-item')) element.closest('.nav-item').classList.add('active');

            document.querySelectorAll('.content-section').forEach(sec => sec.classList.remove('active'));
            const target = document.getElementById(sectionId + '-section');
            if(target) target.classList.add('active');

            // Carrega usuários ao entrar na aba
            if (sectionId === 'users') loadUsers();
        }

        function openRegisterUserModal() {
            const modal = document.getElementById('registerUserModal');
            if(modal) modal.style.display = 'flex';
        }

        function closeUserModal() {
            document.getElementById('registerUserModal').style.display = 'none';
        }

        // --- CRUD USUÁRIOS ---
        async function loadUsers() {
            const tbody = document.getElementById('usersListBody');
            tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">Carregando...</td></tr>';

            try {
                const token = localStorage.getItem('token');
                // IMPORTANTE: Verifica se a rota existe no backend
                const res = await fetch(`https://deploy-render-5o3w.onrender.com/api/usuarios/lista`, {
                    headers: { 'Authorization': `Bearer ${token}` },
                    method: 'GET'
                });
                
                if (!res.ok) throw new Error('Erro na resposta do servidor');
                
                const users = await res.json();
                if (users.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;">Nenhum usuário encontrado.</td></tr>';
                    return;
                }

                tbody.innerHTML = users.map(user => `
                    <tr>
                        <td>${user.nome}</td>
                        <td>${user.email}</td>
                        <td><span style="background:${user.role==='admin'?'#ef4444':'#3b82f6'};color:white;padding:2px 8px;border-radius:10px;font-size:0.8rem;">${user.role}</span></td>
                        <td>${new Date(user.createdAt || Date.now()).toLocaleDateString('pt-BR')}</td>
                        <td>
                            <button class="action-btn-small btn-edit" onclick='openEditUserModal(${JSON.stringify(user)})'><i class="fas fa-edit"></i></button>
                            <button class="action-btn-small btn-delete" onclick="deleteUser('${user._id}')"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `).join('');

            } catch (error) {
                console.error(error);
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center;color:red;">Erro ao carregar (Backend Offline ou Rota não existe).</td></tr>';
            }
        }

        async function registerNewUser() {
            const nome = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const senha = document.getElementById('regPassword').value;
            const role = document.getElementById('regRole').value;

            if (!nome || !email || !senha) return showToast("Preencha todos os campos!", "error");

            try {
                const token = localStorage.getItem('token');
                const res = await fetch('https://deploy-render-5o3w.onrender.com/api/usuarios', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
                    body: JSON.stringify({ nome, email, senha, role })
                });

                if (res.ok) {
                    showToast("Usuário criado!", "success");
                    closeUserModal();
                    document.getElementById('registerUserForm').reset();
                    loadUsers(); // Recarrega a lista
                } else {
                    const data = await res.json();
                    showToast(data.message || "Erro.", "error");
                }F
            } catch (e) { showToast("Erro de conexão.", "error"); }
        }

        async function deleteUser(id) {
            if(!confirm("Tem certeza que deseja excluir este usuário?")) return;
            try {
                const token = localStorage.getItem('token');
                const res = await fetch(`https://deploy-render-5o3w.onrender.com/api/usuarios/${id}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                if (res.ok) { showToast("Usuário excluído.", "success"); loadUsers(); }
                else showToast("Erro ao excluir.", "error");
            } catch (e) { showToast("Erro de conexão.", "error"); }
        }

        function openEditUserModal(user) {
            document.getElementById('editUserId').value = user._id;
            document.getElementById('editUserName').value = user.nome;
            document.getElementById('editUserEmail').value = user.email;
            document.getElementById('editUserRole').value = user.role;
            document.getElementById('editUserPassword').value = '';
            document.getElementById('editUserModal').style.display = 'flex';
        }

        async function updateUser() {
            const id = document.getElementById('editUserId').value;
            const nome = document.getElementById('editUserName').value;
            const email = document.getElementById('editUserEmail').value;
            const role = document.getElementById('editUserRole').value;
            const senha = document.getElementById('editUserPassword').value;

            const payload = { nome, email, role };
            if (senha) payload.senha = senha;

            try {
                const token = localStorage.getItem('token');
                const res = await fetch(`https://deploy-render-5o3w.onrender.com/api/usuarios/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${token}` },
                    body: JSON.stringify(payload)
                });
                
                if (res.ok) {
                    showToast("Usuário atualizado!", "success");
                    document.getElementById('editUserModal').style.display = 'none';
                    loadUsers();
                } else { showToast("Erro ao atualizar.", "error"); }
            } catch (e) { showToast("Erro de conexão.", "error"); }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (user && user.role === 'admin') {
                document.getElementById('admin-divider').style.display = 'block';
                document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'block');
            }
        });

        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const toastMessage = toast.querySelector('.toast-message');
            const toastIcon = toast.querySelector('.toast-icon');
            toastMessage.textContent = message;
            if (type === 'success') {
                toastIcon.className = 'toast-icon fas fa-check-circle'; toast.style.borderLeft = '4px solid #10B981';
            } else if (type === 'error') {
                toastIcon.className = 'toast-icon fas fa-exclamation-circle'; toast.style.borderLeft = '4px solid #ef4444';
            } else {
                toastIcon.className = 'toast-icon fas fa-info-circle'; toast.style.borderLeft = '4px solid #3b82f6';
            }
            toast.classList.add('show');
            setTimeout(() => { toast.classList.remove('show'); }, 3000);
        }
    </script>
</body>
</html>